<%- include('./header.ejs', {title: title}); %>

<div class="row">
    <div class="col-sm-3">
        <div class="modal-content">
            
            <div class="modal-body">
                <p>
                    <h4>Please Entry Shipment</h4>
                </p>
    
                <div class="form-group">
                    <label class="input-label" for="project-bar-input">Shipment</label>
                    <input type="text" class="form-control" id="project-bar-input">
                </div>
            </div>
            <div class="modal-footer">
                
                <button type="submit" onclick="getAttachment(`<%= menuTitle %>`)" class="modal-action btn btn-primary" data-dismiss="modal"
                    id="ReportEndSubmit">Get T1</button>
            </div>
            
        </div>
    </div>
    <div class="col-8">
        <table class="table">
          <thead class="table-dark">
  
              <tr>
                <td class="col">ImportDate</td>
                <td class="col">LogNum</td>
                <td class="col">Shpt</td>
                <td class="col">HAWB</td>
                <td class="col">分單</td>
                <td class="col">Shipment</td>
                <td class="col">Country</td>
                <td class="col">Ship-To</td>
              </tr>
            </thead>
            <tbody>
              <% for(var i=0; i < data.length; i++) { %>
                  <tr>
                      <td><%= data[i]['Act_ImportDateTime'] %></td>
                      <td><%= data[i]['logNum'] %></td>
                      <td><%= data[i]['Shpt'] %></td>
                      <td><%= data[i]['HAWB_NO'] %></td>
                      <td><%= data[i]['5105a'] %></td>
                      <td><%= data[i]['Act_ShipmentNO'] %></td>
                      <td><%= data[i]['Act_Country'] %></td>
                      <td><%= data[i]['Act_ShipTo'] %></td>
                  </tr>
              <% } %>
            </tbody>
        </table>
    </div>
</div>
  

  
  <script>
        $(function () {
            $('#project-bar-input').focus();
            $('.modal-content').keypress(function (e) {
                if (e.which == 13) {
                    var quota = $("#project-bar-input").val();
                    if (quota == "") {
                        alert("no data");
                        
                    } else {
                        if (quota.length >= 8) {
                            postShipment(quota.trim())
                        }  else {
                            alert("Please check Shipment");
                        }
                        
                    }
                }
            })
        });

        var postShipment = function(shipment) {
            $.ajax({
                url: `/post/InformationSet?function=addShipmentToT1&Shipment=${shipment}`,
                type: 'POST',
                success: function (response) {
                //alert(response);
                window.location.reload();
                },
                error: function (e) {
                alert('Error: ' + e);
                }
            });
        }

        var getAttachment = function(functionCtrl) {
            $.ajax({
                url: `/get/mailInfor?function=cuttime_report_mail_webGet&controllog=${functionCtrl}`,
                type: 'GET',
                success: function (response) {
                //alert(response);
                    window.location.reload();
                },
                error: function (e) {
                alert('Error: ' + e);
                }
            });
        }
      

  </script>
  </body>
  </html>